# Azure Event Hubs Configuration with Batch Mode
#
# Sends multiple records in a single message for better throughput

<match logs.**>
  @type azureeventhubs

  connection_string "#{ENV['AZURE_EVENTHUBS_CONNECTION_STRING']}"
  hub_name batch-logs

  # Enable batch mode - send multiple records per message
  batch true

  # Maximum number of records per batch (default: 20)
  max_batch_size 50

  # Include metadata
  include_tag true
  include_time true

  # Message properties for Event Hubs routing
  message_properties {
    "PartitionKey": "application-logs",
    "source": "fluentd",
    "environment": "production"
  }

  <buffer>
    @type memory
    flush_interval 30s
    chunk_limit_size 5M
    flush_thread_count 2
  </buffer>
</match>
